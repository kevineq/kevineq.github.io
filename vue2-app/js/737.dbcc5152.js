"use strict";(self["webpackChunkone_app"]=self["webpackChunkone_app"]||[]).push([[737],{7737:function(t,s,i){i.r(s),i.d(s,{default:function(){return _}});var e=function(){var t=this,s=t._self._c;return s("div",{ref:"article",staticClass:"detail-view"},[s("van-nav-bar",{attrs:{title:t.navTitle,fixed:""},scopedSlots:t._u([{key:"left",fn:function(){return[s("van-icon",{attrs:{name:"arrow-left",size:"20",color:"#bbb"},on:{click:t.back}})]},proxy:!0},{key:"right",fn:function(){return[s("van-icon",{staticClass:"favorite",class:{active:t.isCollect},on:{click:function(s){return s.stopPropagation(),t.collect.apply(null,arguments)}}})]},proxy:!0}])}),8==t.category?s("div",{staticClass:"audio-banner"},[s("div",{staticClass:"play-wrap"},[s("div",{staticClass:"soundwave"},[s("SoundWave",{attrs:{playState:t.playState}})],1),s("div",{staticClass:"play",class:{pause:t.playState},on:{click:t.togglePlay}}),s("div",{staticClass:"soundwave"},[s("SoundWave",{attrs:{playState:t.playState}})],1)])]):t._e(),4==t.category?s("div",{staticClass:"music-banner"},[s("div",{staticClass:"music-bg"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.bgImage,expression:"bgImage"}],attrs:{alt:""}})]),s("div",{staticClass:"music-cover"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.cover,expression:"cover"}],attrs:{alt:""}})]),s("div",{staticClass:"music-disk",class:{disk:t.playState}},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.disk,expression:"disk"}],attrs:{alt:""}})]),s("div",{staticClass:"music-play",class:{play:t.playState},on:{click:t.play}}),s("div",{staticClass:"music-info"},[t._v(t._s(t.info))])]):t._e(),s("div",{staticClass:"detail-wrap"},[s("h2",{staticClass:"aticle-title"},[t._v(t._s(t.title))]),s("div",{staticClass:"info"},[s("p",{staticClass:"author"},[t._v(t._s(t.author))]),t.volume?s("div",{staticClass:"volume"},[t._v(t._s(t.volume))]):t._e()]),t.brief?s("div",{staticClass:"brief"},[t._v(t._s(t.brief))]):t._e(),t.simple?s("div",{staticClass:"simple"},[t._v(t._s(t.simple))]):t._e(),t.audio&&8!=t.category?s("div",{staticClass:"audio-box",on:{click:t.play}},[s("van-icon",{attrs:{name:"volume-o"}}),s("div",{staticClass:"audio-anchor"},[t._v("有声读物 | "+t._s(t.anchor))]),s("div",{staticClass:"audio-duration"},[t._v(t._s(t.durationStr))])],1):t._e(),s("div",{staticClass:"html-content",domProps:{innerHTML:t._s(t.content)}}),s("p",{staticClass:"editor"},[t._v(t._s(t.editor))]),s("p",{staticClass:"copyright"},[t._v(t._s(t.copyright))]),t.authorList.length?s("div",{staticClass:"author-list"},[s("span",{staticClass:"detail-label"},[t._v(t._s(8==this.category?"主播":"作者"))]),t._l(t.authorList,(function(i){return s("div",{key:i.user_id,staticClass:"author-card"},[s("img",{attrs:{src:i.web_url}}),s("div",{staticClass:"user-desc"},[s("h3",{staticClass:"user-name"},[t._v(t._s(i.user_name)+" "+t._s(i.wb_name))]),s("p",[t._v(t._s(i.summary))])]),s("span",{staticClass:"follow-btn"},[t._v("关注")])])}))],2):t._e(),t.ratingList.length?s("div",{ref:"rating",staticClass:"rating-list"},[s("span",{staticClass:"detail-label"},[t._v("评论列表")]),s("ul",t._l(t.ratingList,(function(i,e){return s("li",{key:e,staticClass:"rating-list-item"},[s("div",{staticClass:"avatar"},[s("img",{attrs:{src:i.user.web_url}})]),s("div",{staticClass:"rating-desc"},[s("h3",{staticClass:"user-name"},[t._v(t._s(i.user.user_name))]),s("span",{staticClass:"time"},[t._v(t._s(i.input_date.toLocaleString().split(" ")[0].split("-").join(".")+" "+i.input_date.toLocaleString().split(" ")[1].slice(0,-3)))]),i.quote?s("div",{staticClass:"quote-box"},[s("div",{staticClass:"van-multi-ellipsis--l2 quote"},[t._v(" "+t._s(i.quote)+" ")])]):t._e(),s("p",{staticClass:"rating-content"},[t._v(t._s(i.content))]),s("div",{staticClass:"btn-bar"},[s("div",{staticClass:"comment"}),s("div",{staticClass:"good"}),s("div",{staticClass:"praisenum"},[t._v(t._s(i.praisenum))])])])])})),0)]):t._e(),t.audio?s("audio",{attrs:{src:t.audio},on:{canplay:t.getAudioDuration}}):t._e()]),s("div",{staticClass:"comment-user"},[s("div",{staticClass:"com",on:{click:t.showPopup}},[t._v("写一个评论...")]),s("div",{staticClass:"icon1"},[s("div",{staticClass:"icon-feeds_laud_default",class:{active:t.isLike},on:{click:function(s){return s.stopPropagation(),t.like.apply(null,arguments)}}}),s("div",{ref:"like"},[t._v(t._s(t.praisenum))])]),s("div",{staticClass:"icon2",on:{click:t.ratingBtn}},[s("div",{staticClass:"commento"}),s("div",{ref:"commento"},[t._v(t._s(t.commentnum))])]),s("div",{staticClass:"icon-feeds_share",on:{click:t.share}})]),s("van-popup",{staticClass:"text-box",attrs:{position:"bottom"},model:{value:t.show,callback:function(s){t.show=s},expression:"show"}},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],attrs:{placeholder:"在这里写下你想说的..."},domProps:{value:t.value},on:{input:function(s){s.target.composing||(t.value=s.target.value)}}}),s("div",{staticClass:"text-info"},[s("div",{staticClass:"text-count"},[t._v(t._s(t.textCount))]),s("div",{staticClass:"sub",style:{backgroundColor:t.bgColor},on:{click:t.submit}},[t._v(" 发送 ")])])])],1)},a=[],o=(i(7658),i(541),i(4787)),r=function(){var t=this,s=t._self._c;return s("div",{staticClass:"sound-wave"},t._l(t.count,(function(i){return s("div",{key:i,staticClass:"wave-item",class:{play:t.playState}})})),0)},n=[],l={props:{playState:Boolean},data(){return{count:11}}},c=l,h=i(1001),u=(0,h.Z)(c,r,n,!1,null,"2caa99c0",null),d=u.exports,v=i(3822),m={beforeRouteEnter(t,s,i){i((t=>{let s=[];for(let i=0;i<localStorage.length;i++){let t=localStorage.key(i);"article"==t.slice(0,7)?s.push(t.slice(8)):("music"==t.slice(0,5)||"movie"==t.slice(0,5)||"radio"==t.slice(0,5))&&s.push(t.slice(6))}t.keyArr=s}))},props:{playState:Boolean},data(){return{title:"",author:"",audio:"",anchor:"",content:"",editor:"",copyright:"",authorList:[],ratingList:[],contentId:"",category:"",duration:0,volume:0,praisenum:0,commentnum:0,brief:"",simple:"",bgImage:"",disk:"",cover:"",info:"",music:"",scrollTop:0,show:!1,value:"",isLike:!1,isCollect:!1,keyArr:[]}},computed:{...(0,v.rn)(["collectObj"]),bgColor(){return this.value.length>0?"#fff":"#ccc"},textCount(){return 500-this.value.length},navTitle(){return o.wL[this.$route.query.category]},durationStr(){let t=Math.floor(this.duration/60),s=Math.floor(this.duration%60);return t=t>=10?t:"0"+t,s=s>=10?s:"0"+s,t+":"+s}},methods:{share(){this.$router.push("/share")},collectYesOrNo(){this.isCollect=!1,this.$nextTick((()=>{let t=this.keyArr.indexOf(this.category+"-"+this.contentId);t>-1&&(this.isCollect=!0)}))},collect(){if(0==this.isCollect){let t="";t=4==this.category?"music-"+this.category+"-"+this.contentId:5==this.category?"movie-"+this.category+"-"+this.contentId:8==this.category?"radio-"+this.category+"-"+this.contentId:"article-"+this.category+"-"+this.contentId;let s={id:this.contentId,category:this.category,title:this.collectObj.title,subtitle:this.collectObj.subtitle,cover:this.collectObj.cover};s=JSON.stringify(s),localStorage[t]=s,this.isCollect=!0,this.$toast({message:"已收藏至个人中心",position:"bottom"})}else{let t="";t=4==this.category?"music-"+this.category+"-"+this.contentId:5==this.category?"movie-"+this.category+"-"+this.contentId:8==this.category?"radio-"+this.category+"-"+this.contentId:"article-"+this.category+"-"+this.contentId,localStorage.removeItem(t),this.isCollect=!1,this.$toast({message:"取消收藏",position:"bottom"})}},like(){0==this.isLike?(this.isLike=!0,this.$refs.like.textContent++):(this.isLike=!1,this.$refs.like.textContent--)},submit(){this.value?(this.ratingList.unshift({user:{web_url:"../assets/img/user.jpg",user_name:"kevin"},input_date:"2022-11-08 "+(new Date).toLocaleString().split(" ")[1],content:this.value,praisenum:0}),this.$toast({message:"发布成功",position:"bottom"}),this.show=!1,this.value="",this.$refs.article.scrollTop=this.$refs.rating.offsetTop,this.$refs.commento.textContent++):this.$toast({message:"无法发送空内容",position:"bottom"})},showPopup(){this.show=!0},ratingBtn(){this.$refs.article.scrollTop+1<this.$refs.rating.offsetTop?(this.scrollTop=this.$refs.article.scrollTop,this.$refs.article.scrollTop=this.$refs.rating.offsetTop):this.$refs.article.scrollTop=this.scrollTop},getAudioDuration(t){this.duration=t.target.duration},back(){this.$router.go(-1)},play(){let t="";t=4==this.category?this.music:this.audio,this.$emit("set-audio-src-and-play",{src:t,title:this.title,anchor:this.anchor,articlePath:this.$route.fullPath})},saveArticleDataUseSessionStorage(t,s){let i=t+"-"+s,e={title:this.title,author:this.author,audio:this.audio,anchor:this.anchor,content:this.content,editor:this.editor,copyright:this.copyright,authorList:this.authorList,volume:this.volume,praisenum:this.praisenum,commentnum:this.commentnum,brief:this.brief,simple:this.simple,bgImage:this.bgImage,disk:this.disk,cover:this.cover,info:this.info,music:this.music};e=JSON.stringify(e),sessionStorage[i]=e},saveArticleRatingsUseSessionStorage(t,s){let i="rating-"+t+"-"+s,e=this.ratingList;e=JSON.stringify(e),sessionStorage[i]=e},getArticleDataAndRatingsData(){let{category:t,id:s}=this.$route.query;this.category=t,this.contentId=s;let i=sessionStorage[t+"-"+s],e=sessionStorage["rating-"+t+"-"+s];i&&e?(i=JSON.parse(i),this.title=i.title,this.author=i.author,this.audio=i.audio,this.anchor=i.anchor,this.content=i.content,this.editor=i.editor,this.copyright=i.copyright,this.authorList=i.authorList,this.volume=i.volume,this.praisenum=i.praisenum,this.commentnum=i.commentnum,this.brief=i.brief,this.simple=i.simple,this.bgImage=i.bgImage,this.disk=i.disk,this.cover=i.cover,this.info=i.info,this.music=i.music,e=JSON.parse(e),this.ratingList=e,this.$nextTick((()=>{8==this.category&&this.audio&&this.play()}))):((0,o.PQ)({axios:this.$axios,id:s,category:t}).then((({data:i})=>{let e=i.data;this.title=e.json_content.title,this.author=e.json_content.simple_author[0],this.audio=e.audio,this.anchor=e.anchor,this.content=e.json_content.content,this.editor=e.json_content.editor,this.copyright=e.json_content.copyright,this.authorList=e.author_list,this.volume=e.json_content.simple_author[1],this.praisenum=e.praisenum,this.commentnum=e.commentnum,this.brief=e.json_content.question_brief,this.simple=e.json_content.simple_answerer,this.bgImage=e.json_content.music_header?.bg,this.disk=e.json_content.music_header?.disk,this.cover=e.json_content.music_header?.cover,this.info=e.json_content.music_header?.info,this.music=e.json_content.audio_url,this.saveArticleDataUseSessionStorage(t,s),this.$nextTick((()=>{8==this.category&&this.audio&&this.play()}))})),(0,o.yv)({axios:this.$axios,category:t,id:s}).then((({data:i})=>{this.ratingList=i.data.data,this.saveArticleRatingsUseSessionStorage(t,s)})))},togglePlay(){this.$emit("play-or-pause")}},activated(){this.collectYesOrNo();let{category:t,id:s}=this.$route.query;this.category==t&&this.contentId==s||this.getArticleDataAndRatingsData()},components:{SoundWave:d}},p=m,g=(0,h.Z)(p,e,a,!1,null,"7c43313a",null),_=g.exports}}]);
//# sourceMappingURL=737.dbcc5152.js.map